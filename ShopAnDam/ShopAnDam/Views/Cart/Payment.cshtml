@model List<ShopAnDam.Models.CartItem>
@using ShopAnDam.Common;
@{
    ViewBag.Title = "Payment";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var session = (CustomerLogin)Session[CommonConStants.USER_SESSION];
}

@section jsFooter{
    <script src="~/Assets/client/js/controller/Payment.js"></script>
    <link href="~/Assets/client/css/PaymentStyle.css" rel="stylesheet" />
    }

<!-- Breadcrumb Section Begin -->
<div class="breacrumb-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb-text product-more">
                    <a href="/"><i class="fa fa-home"></i> Trang chủ</a>
                    <a href="/san-pham" class="fa fa-plus-circle">Sản phẩm</a>
                    <span>Thanh toán</span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Breadcrumb Section Begin -->
<!-- Shopping Cart Section Begin -->
<section class="checkout-section spad">
    <div class="container">
        <form action="#" class="checkout-form">

            <div class="row">
                @if (Model.Count > 0)
                {
                    if (session != null)
                    {
                        <div class="col-lg-6">
                            <div class="checkout-content">
                                <a href="/dang-nhap" class="content-btn">ĐĂNG NHẬP TÀI KHOẢN </a>
                            </div>
                            <h4>HÓA ĐƠN CHI TIẾT</h4>
                            <div class="row">
                                @using (Html.BeginForm("Payment", "Cart", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    <div class="col-lg-12">
                                        <label for="Name">Họ và tên<span>*</span></label>
                                        <input type="text" id="Name" class="form-control" name="Name" placeholder="Tên người nhận" value="@session.Name" required>
                                    </div>
                                    <div class="col-lg-12">
                                        <label for="ProvinID">Tỉnh<span>*</span></label>
                                        @Html.DropDownList("ProvintID", new SelectList(new string[] { }), htmlAttributes: new { @class = "form-control", @id = "ddlProvint", @session.ProvinID })
                                        <input type="hidden" id="hdnTenTinhThanh" name="hdnTenTinhThanh" />
                                    </div>
                                    <div class="col-lg-12">
                                        <label for="DistricID">Huyện<span>*</span></label>
                                        @Html.DropDownList("DistrictID", new SelectList(new string[] { }), htmlAttributes: new { @class = "form-control", @id = "ddlDistrict", @session.DistricID })
                                        <input type="hidden" id="hdnTenQuanHuyen" name="hdnTenQuanHuyen" />
                                    </div>
                                    <div class="col-lg-12">
                                        <label for="Address">Địa chỉ<span>*</span></label>
                                        <input type="text" id="Address" class="street-first form-control" name="Address" placeholder="Địa chỉ cụ thể" value="@session.Address" required>
                                    </div>
                                    <div class="col-lg-6">
                                        <label for="Email">Email<span>*</span></label>
                                        <input type="text" id="Email" class=" form-control" name="Email" placeholder="Email người nhận" value="@session.Email" required>

                                    </div>
                                    <div class="col-lg-6">
                                        <label for="Phone">Số điện thoại<span>*</span></label>
                                        <input type="number" id="Phone" class=" form-control" name="Phone" placeholder="Số điện thoại người nhận" value="@session.Phone" required>
                                    </div>

                                }
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="col-lg-6">
                            <div class="checkout-content">
                                <a href="/dang-nhap" class="content-btn">ĐĂNG NHẬP TÀI KHOẢN</a>
                            </div>
                            <h4>HÓA ĐƠN CHI TIẾT</h4>
                            <div class="row">
                                @using (Html.BeginForm("Payment", "Cart", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    <div class="col-lg-12">
                                        <label for="Name">Họ và tên<span>*</span></label>
                                        <input type="text" id="Name" class="form-control" name="Name" placeholder="Tên người nhận" required>
                                    </div>
                                    <div class="col-lg-12">
                                        <label for="ProvinID">Tỉnh<span>*</span></label>
                                        @Html.DropDownList("ProvintID", new SelectList(new string[] { }), htmlAttributes: new { @class = "form-control", @id = "ddlProvint" })
                                        <input type="hidden" id="hdnTenTinhThanh" name="hdnTenTinhThanh" />
                                    </div>
                                    <div class="col-lg-12">
                                        <label for="DistricID">Huyện<span>*</span></label>
                                        @Html.DropDownList("DistrictID", new SelectList(new string[] { }), htmlAttributes: new { @class = "form-control", @id = "ddlDistrict" })
                                        <input type="hidden" id="hdnTenQuanHuyen" name="hdnTenQuanHuyen" />
                                    </div>
                                    <div class="col-lg-12">
                                        <label for="Address">Địa chỉ<span>*</span></label>
                                        <input type="text" id="Address" class="street-first form-control" name="Address" placeholder="Địa chỉ cụ thể" required>
                                    </div>
                                    <div class="col-lg-6">
                                        <label for="Email">Email<span>*</span></label>
                                        <input type="text" id="Email" class=" form-control" name="Email" placeholder="Email người nhận" required>

                                    </div>
                                    <div class="col-lg-6">
                                        <label for="Phone">Số điện thoại<span>*</span></label>
                                        <input type="number" id="Phone" class=" form-control" name="Phone" placeholder="Số điện thoại người nhận" required>
                                    </div>

                                }
                            </div>
                        </div>
                    }

                }
                else
                {
                    <div class="col-lg-6">
                        <div class="checkout-content">
                            <a href="/dang-nhap" class="content-btn">ĐĂNG NHẬP TÀI KHOẢN </a>
                        </div>
                        <h4>HÓA ĐƠN CHI TIẾT</h4>
                        <div class="row">
                            @using (Html.BeginForm("Payment", "Cart", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                <div class="col-lg-12">
                                    <label for="Name">Họ và tên<span>*</span></label>
                                    <input type="text" id="Name" class="form-control" name="Name" placeholder="Tên người nhận" required>
                                </div>
                                <div class="col-lg-12">
                                    <label for="ProvinID">Tỉnh<span>*</span></label>
                                    @Html.DropDownList("ProvintID", new SelectList(new string[] { }), htmlAttributes: new { @class = "form-control", @id = "ddlProvint" })
                                    <input type="hidden" id="hdnTenTinhThanh" name="hdnTenTinhThanh" />
                                </div>
                                <div class="col-lg-12">
                                    <label for="DistricID">Huyện<span>*</span></label>
                                    @Html.DropDownList("DistrictID", new SelectList(new string[] { }), htmlAttributes: new { @class = "form-control", @id = "ddlDistrict" })
                                    <input type="hidden" id="hdnTenQuanHuyen" name="hdnTenQuanHuyen" />
                                </div>
                                <div class="col-lg-12">
                                    <label for="Address">Địa chỉ<span>*</span></label>
                                    <input type="text" id="Address" class="street-first form-control" name="Address" placeholder="Địa chỉ cụ thể" required>
                                </div>
                                <div class="col-lg-6">
                                    <label for="Email">Email<span>*</span></label>
                                    <input type="text" id="Email" class=" form-control" name="Email" placeholder="Email người nhận" required>

                                </div>
                                <div class="col-lg-6">
                                    <label for="Phone">Số điện thoại<span>*</span></label>
                                    <input type="number" id="Phone" class=" form-control" name="Phone" placeholder="Số điện thoại người nhận" required>
                                </div>

                            }
                        </div>
                    </div>
                }

                <div class="col-lg-6">
                    <div class="checkout-content">
                        <input type="text" placeholder="MÃ GIẢM GIÁ">
                    </div>
                    <div class="place-order">
                        <h4>THÔNG TIN HÓA ĐƠN</h4>

                        <div class="order-total">
                            <ul class="order-table">
                                @if (Model.Count > 0)
                                {
                                    decimal? tong_tien = 0;
                                    decimal? thanh_tien = 0;
                                    <li>Sản phẩm <span>Thành tiền</span></li>
                                    foreach (var item in Model)
                                    {
                                        var url = "/chi-tiet/" + item.Product.MetaTitle + "/" + item.Product.ID;


                                        if (item.Product.MotionPrice != null)
                                        {
                                            thanh_tien = item.Quantity * (item.Product.MotionPrice.HasValue && (item.Product.MotionPrice.ToString() != "0") ? item.Product.MotionPrice : item.Product.Price);
                                            tong_tien += thanh_tien;
                                        }
                                        else
                                        {
                                            thanh_tien = item.Quantity * (item.Product.MotionPrice.HasValue && (item.Product.MotionPrice.ToString() != "0") ? item.Product.Price : 0);
                                            tong_tien += thanh_tien;
                                        }


                                        <li class="fw-normal"><a href="@url">@item.Product.Name</a> x @item.Quantity <span>@thanh_tien.Value.ToString("N0") </span></li>
                                    }
                                    <li class="total-price">Tổng Tiền <span>@tong_tien.Value.ToString("N0")</span></li>

                                }
                                else
                                {
                                    <li>Sản phẩm <span>Thành tiền</span></li>
                                    <li class="fw-normal" style="text-align:center">Chưa có sản phẩm nào !</li>
                                    <li class="total-price">Tổng Tiền <span>0 VNĐ</span></li>
                                }



                            </ul>
                            @using (Html.BeginForm("Payment", "Cart", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                @*  <div class="payment-check">
                                <div class="pc-item">
                                    <label>
                                        Thanh toán khi nhận hàng (COD)
                                        <input type="radio" id="rdo_COD" name="option_payment" value="COD" checked="checked" /><span class="checkmark"></span>
                                    </label>

                                </div>
                                <div class="pc-item">

                                    <label for="pc-paypal">
                                        Thanh toán bằng Ví điện tử NgânLượng
                                        <input type="radio" id="rdo_nganluong" name="option_payment" value="NL" />
                                        <span class="checkmark"></span>
                                    </label>

                                </div>
                                <div class="pc-item">

                                    <label for="pc-paypal">
                                        Thanh toán online bằng thẻ ngân hàng nội địa
                                        <input type="radio" id="rdo_bank" name="option_payment" value="ATM_ONLINE" />
                                        <span class="checkmark"></span>
                                    </label>
                                    <input type="hidden" name="FormOfPayment" id="hdnFormOFPayment" value="COD" />

                                </div>
                            </div>*@
                                <div class="order-btn">
                                    <button type="submit" class="site-btn place-btn">ĐẶT HÀNG</button>
                                </div>
                                <p>Vui lòng kiểm tra kĩ hóa đơn trước khi đặt hàng </p>
                            }
                        </div>
                    </div>
                </div>
            </div>
          
            
            </form>
        </div>
</section>
<!-- Shopping Cart Section End -->
